FROM ubuntu:16.04
MAINTAINER xiaoyulei

RUN apt-get update && apt-get dist-upgrade -y && \
apt-get install -y wget openssh-server cmake build-essential gcc g++ autoconf automake git emacs vim sysstat libclang-dev clang pkg-config zlib1g-dev openssl

RUN useradd -Groot,sudo -m -s /bin/bash xiaoyulei
USER xiaoyulei
WORKDIR /home/xiaoyulei

RUN mkdir tools && \
cd tools && \
git clone https://github.com/YuleiXiao/emacsconfig.git && \
ln -s $PWD/emacsconfig $HOME/.emacs.d
wget https://dl.google.com/go/go1.10.linux-amd64.tar.gz && \
tar xvf go1.10.linux-amd64.tar.gz && \
git clone https://github.com/Andersbakken/rtags.git --recursive $HOME/tools/rtags && \
mkdir -p $HOME/tools/rtags/build && \
cd $HOME/tools/rtags/build && \
cmake .. && make

ENV GOROOT /home/xiaoyulei/tools/go
ENV PATH $GOROOT/bin:/home/xiaoyulei/tools/rtags/build/bin:$PATH
CMD ["/usr/sbin/init"]
